# ğŸš€ QUICK REFERENCE - AI Personality System v2.0

## ğŸ“‹ Podstawowe Komendy

### Testy i Diagnostyka
```powershell
# Test systemu v2.0
python -c "from persona_context_builder import build_enhanced_context; print('âœ… OK')"

# Zobacz kontekst AI
python persona_context_builder.py

# SprawdÅº knowledge base
python knowledge_base_updater.py

# Audyt miesiÄ™czny
python monthly_audit.py
```

### Backup i Maintenance
```powershell
# Backup pamiÄ™ci
Copy-Item persona_memory.json "persona_memory_backup_$(Get-Date -Format 'yyyyMMdd_HHmmss').json"

# SprawdÅº rozmiar pliku
(Get-Item persona_memory.json).Length / 1KB
```

---

## ğŸ­ Profile PartnerÃ³w (Quick Ref)

| Persona | Mood Default | Risk | Voting | Goal |
|---------|--------------|------|--------|------|
| **Benjamin Graham** ğŸ›¡ï¸ | neutral | 0.3 | 5% | Zero strat |
| **Warren Buffett** ğŸ¡ | optimistic | 0.5 | 5% | Quality compounders |
| **Philip Fisher** ğŸ”¬ | excited | 0.7 | 5% | Growth 25%+ ROE |
| **George Soros** ğŸŒ | cautious | 0.6 | 5% | Reflexivity detection |
| **CZ** âš¡ | excited | 0.8 | 5% | 30% crypto allocation |
| **Partner ZarzÄ…dzajÄ…cy** ğŸ‘” | neutral | 0.6 | 35% | Sustainable growth |
| **Partner Strategiczny** ğŸ¯ | confident | 0.7 | 30% | Market leadership |

---

## ğŸ“Š Voting Weight Bonuses

```
Base Weight (Kodeks): 
- JA: 35%
- Partner Strategiczny: 30%
- Others: 5% each

Credibility Bonus Range: -2% to +3%

Formula:
effective_weight = base_weight + ((credibility_score - 1.0) * 3)

Examples:
- credibility 1.0 (100%) â†’ bonus 0% â†’ effective = base
- credibility 0.8 (80%) â†’ bonus -0.6% â†’ effective = base - 0.6%
- credibility 1.2 (120% impossible but...) â†’ bonus +0.6% â†’ effective = base + 0.6%
```

---

## ğŸ¯ Mood System

### Moods
| Mood | Emoji | Trigger |
|------|-------|---------|
| **excited** | ğŸ”¥ | Big win (>500 PLN) |
| **confident** | ğŸ’ª | Multiple wins |
| **optimistic** | ğŸ˜Š | Small win |
| **neutral** | ğŸ˜ | Default |
| **cautious** | ğŸ¤” | High market volatility |
| **worried** | ğŸ˜Ÿ | Small loss |
| **fearful** | ğŸ˜° | Big loss (>1000 PLN) |
| **angry** | ğŸ˜  | Failed prediction |
| **disappointed** | ğŸ˜ | Missed opportunity |

### Mood Affects
- **excited** â†’ More aggressive recommendations, higher risk tolerance
- **fearful** â†’ Conservative moves, recommends cash
- **confident** â†’ Bold calls, references past wins
- **worried** â†’ Extra cautious, mentions concerns frequently

---

## ğŸ¤ Relationship Dynamics

### Trust Levels
- ğŸŸ¢ **High (>70%)**: "I agree with [Partner]", supportive tone
- ğŸŸ¡ **Medium (40-70%)**: Neutral, objective analysis
- ğŸ”´ **Low (<40%)**: "I disagree with [Partner]", contrarian stance

### Trust Changes
```python
Agreement on decision: trust += 0.05
Disagreement (one correct): trust -= 0.1
Alliance (joint proposal): trust += 0.1
Conflict (opposing views): trust -= 0.05
```

---

## ğŸ“š Knowledge Base

### Update Frequency
â° **Every 12 hours** (via Task Scheduler)

### Sources
- **Yahoo Finance**: Market news, earnings
- **Seeking Alpha**: Analysis, opinions
- **Bloomberg**: Global macro news

### Tags
- `macro` â†’ Fed, interest rates, GDP
- `earnings` â†’ Company results
- `tech` â†’ Apple, Microsoft, Google
- `crypto` â†’ Bitcoin, Ethereum, Binance
- `m&a` â†’ Mergers, acquisitions
- `energy` â†’ Oil, gas, renewables

### Usage in Prompts
AI partners automatically reference recent articles when relevant:
> "Based on recent Yahoo Finance report about Fed rate cuts..."

---

## ğŸ”® Prediction System

### Recording Prediction
```python
{
  "ticker": "AAPL",
  "direction": "UP",  # UP, DOWN, NEUTRAL
  "entry_price": 175.50,
  "forecast_price": 190.00,
  "confidence": 0.75,  # 0-1
  "timeframe": "3M",
  "reasoning": "Strong iPhone sales...",
  "due_date": "2026-01-21",
  "status": "active"  # active, resolved
}
```

### Monthly Audit Checks
1. Fetches current price
2. Compares direction: `current_price > entry_price`
3. Calculates accuracy: `100 - abs(forecast_change% - actual_change%)`
4. Updates credibility score
5. Changes mood based on result
6. Evolves personality traits
7. Adjusts voting weight bonus

---

## ğŸ§¬ Personality Evolution

### Traits That Evolve
- `risk_tolerance` â†’ After losses: -0.05, After wins: +0.05
- `optimism_bias` â†’ After failed predictions: -0.1
- `patience` â†’ After impulsive losses: +0.05

### Learning Patterns
```json
{
  "mistake_categories": {
    "crypto_overallocation": 3,  # Count
    "timing_error": 2
  },
  "improvement_strategies": [
    "Reduce crypto exposure to <20%",
    "Wait for RSI < 30 before buying"
  ]
}
```

---

## âš™ï¸ Configuration Files

### `persona_memory.json`
**Current size**: 1626 lines  
**Backup frequency**: Before each major operation  
**Location**: Root directory

### `knowledge_base/articles.json`
**Max age**: 14 days (older removed)  
**Current count**: 9 articles  
**Update**: Every 12h via `run_knowledge_updater.bat`

### `monthly_snapshot.json`
**Generated by**: `monthly_audit.py`  
**Contains**: Summary of predictions evaluated, persona results

---

## ğŸ› Troubleshooting

### "No module named 'feedparser'"
```powershell
pip install feedparser beautifulsoup4 requests
```

### "MEMORY_V2 not found"
Check imports in `streamlit_app.py` line 30:
```python
from persona_context_builder import build_enhanced_context, get_emotional_modifier
```

### Knowledge base not updating
1. Check Task Scheduler: task enabled?
2. Check logs: `logs\knowledge_base.log`
3. Manual run: `python knowledge_base_updater.py`

### Credibility not changing
1. Ensure decisions have `outcome` field ('success'/'failure')
2. Run `monthly_audit.py` manually
3. Check `persona_memory.json` for updated `credibility_score`

### Progress bar crash (negative values)
Fixed in streamlit_app.py line 4935:
```python
normalized_value = max(0.0, min(1.0, value))
st.progress(normalized_value)
```

---

## ğŸ“ˆ Performance Tips

### Optimize Token Usage
- Limit context: `build_enhanced_context(name, limit=3)` instead of 5
- Reduce verbosity in communication_style
- Shorten catchphrases list

### Reduce File Size
- Archive old decisions (>6 months)
- Limit mood_history to last 10 (currently 20)
- Compress notable_moments in relationships

### Speed Up Knowledge Base
- Reduce max articles per source (currently 10)
- Increase deduplication frequency
- Cache HTTP requests

---

## ğŸ¯ Best Practices

### When Talking to AI Partners
1. âœ… Reference recent portfolio performance
2. âœ… Ask about specific tickers
3. âœ… Request confidence levels
4. âœ… Save important decisions with ğŸ’¾ button

### After Big Portfolio Changes
1. ğŸ”„ Update emotional states manually if needed
2. ğŸ“ Record key decisions immediately
3. ğŸ“Š Check Track Record tab (TAB 7)

### Monthly Routine
1. ğŸ“… 1st of month: Run `monthly_audit.py`
2. ğŸ“Š Check leaderboard in TAB 7
3. ğŸ“ˆ Review personality evolution
4. ğŸ’¾ Backup persona_memory.json

---

## ğŸ”— Related Files

- **Documentation**: `AI_PERSONALITY_SYSTEM_V2.md`
- **Upgrade Summary**: `UPGRADE_SUMMARY_V2.md`
- **Original Guide**: `AI_MEMORY_GUIDE.md`
- **Quick Start**: `QUICK_START.md`

---

**Version**: 2.0  
**Last Updated**: 21.10.2025  
**Status**: Production Ready âœ…
